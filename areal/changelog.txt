   014
   16.03.2020
Растение
живет: 94 такта
потребляет за жизнь: 242 единицы почвы
производит 4 потомков

во время деления переменная all_consumed_food в классе Plant немного просаживается. Должно ли так быть?

Теперь классы Seed и Plant наследуются от класса Being. Сам класс Being мог бы наследоваться от чего-то
более общего, неодушевленного (Thing), а от него и Rot. Полумать надо/ Унификация - круто.

   015
   17.03.2020
год увеличил до 24 дней
срок жизно растения изменил на 4 года. итого 96 дней
растения способны плодиться раз в полгода (12 дней)
Это все ради более круглых цифр (делится на 2, 3, 4, 6)
За время жизни растения поглощают до 163 единиц почвы
Оказаалось, что растения успеют только двух потомков потодить за время жизни. Мало.
Увеличил плодоношение до 4 раз в год.
Почему то создается ощущение, что это не 4 раза в год, а 4 раза за жизнь.
Размножение у растений происходит значительно реже, чем это позволяет период размножения.
Но все таки сокращение периода некоторым образом влияет на скорость размножения. надо выяснить,
почему это происходит.

   016
   18.03.2020
Закон сохранения массы в прошлой и этой верстии совсем не соблюдается. Семена принесли проблемы
Правильое количество и масса семян показывается тольк на следующем ходу. В момент, когда растения
плодоносят, семена в статистику не попадают.
Посмотрел, в версиях без семян закон сохранения массы худо-бедно сохранялся.
При каждом создании семян обЩая масса мира уменьшается на массу новосозданных семян.
Очевидная ошибка. Общая масса уменьшалась, потому что к ней не плюсовалась масса семян.

   017
   18.04.2020
Решил вернуться к ареалу, чтобы отработать не нем некоторые идеи, которы потом надо будет внедрить
в социум. В частности это графический интерфейс с кнопочками и запись информации о симуляции в
базу данных вместо кучи текстовых файлов.
Пока стелал следующее: вынес основные константы в отдельный файл и отказался от конфигурационного
файла. Уж больно замудренно с этим конфигом программа инициализировалась. А как сделать это
прозрачно, я не знаю. А сейчас данные сгруппированы в одном месте и все инициализируется по уму.

На будущее - осовоить поускаение и поднимание объектов на холсте, а то семена все заспамливают и
из-за них не видно растений.
Так же неплохо будет ограничить количество семян на клетку, уж очень их много.

Не нравится мне, что некоторые величины вычисляются по нескольку раз. Нарпимер вычисляется полная
масса растений и гнили для каждой клетки, а потом вычислается полная масса для всего игрового
поля - и тоже идет пробег по всем растениям, а не по клеткам - там ведь уже все вычислено.
От лишних вычислений я избавился.

А так же не нравится что поля (клетки) хранятся в виде двумерного массива. Проще было бы
обрабатывать их просто как список. Точную позицию клетки на игровом поле мне нужно хнать только
для того, чтобы сбрасывать семена в соседние клетки. Да и то, список соседей для каждой клетки
уже определен. Поэтому после первоначальной инициализации клетки можно преобразовать в список.
Или в словарь и обращаться к эдементам - если так нужно - по тексотвому ключу, содержащему
координаты клетки. типа "10 12".

Есть идея. Вместо квадратиков, изображающих растения писать на каждой клетке число растений,
размещенных на ней. Как-то лаконичней будет. Не будет адской каши из семян и гнили. Это
отдельным режимом можно сделать.

   018
   18.04.2020
Переписал базовый класс для растений, теперь он стал более абстрактный. Теперь его наследует и
класс Rot. Базовый класс срисует сущности. А парамерты рисования ему передаются из словаря
cn.DRAW_PARAMS - там для гнили иемян и растений отдельные подсловарики.
Еще сделал, что отрисовку всего, кроме клеток можно отключить. Работает заметно быстрее. Это
мне нужно для проведения серий опытов с разными параметрами семян.
Еще нужно сделать чекбоксы, чтобы можно было запрещать отрисовку растений, семян и гнили по
отдельности.

   019
   26.04.2020
На данном этапе чекбоксы, указывающие отрисовывать или нет ту или иную сущность работают
нормально.
Пытвюсь разобраться с ошибкой, когда гниль внезап но начинает рисоваться зеленым цветом и думает,
что она растение. Это видно на клетках где мало пищи. Светлозеленый сменяется на темнозеленый и
обратно. Ошибка плавающая. Хотя генератор случайных чисел зафиксирован, после рестарта зеленые
точки появляются в самый неожиданный момент. При первом запуске результат повторяется. Тут скорее
всего с памятью какая-то ошибка - что то видимо нерпавильно добавляю или удаляю из словарей.
В память я конечно же не полез, а запилил всплявающие подсказки. Когда наводишь на объект, над
ним появляется подсказка с некоторой информацией об объекте. Так вот для зеленой гнили явно
указывается, что это гниль, а никакое не растение.
На долгом времени симцляции подсказки начинают тормозить. При наведении на объект, они не не
появояются, но вешают окно. При уводе курсора симуляция продолжается. Не знаю, что это такое.
Возможно старые подсказки не удаляются и их список сильно растет. Но это только моя догадка. Если
поставить на паузу, подсказки начинают отображаься с нормальной скоростью (когда дело еще не
дошло до зависаний). Начиная примерно с 19 000 хода полсказки перестают выводиться  онлайн. При
остановленной симуляции изрядно тормозят, а потом перестают выводиться вообще. К тому времени
номера объектов на экрпне находяься в районе 372 000.
Но в целом эта фича нужна только для отладки. В релизе будут подсказки, привязанные к клеткам, а
не к отдельным растениям. При Наведении на клетку будет демонстрироваться, сколько на ней семян,
растений и т. д.
Нормальную отладку затрудняет то, что это графический интерфейс и до многих данных графических
объектов я просто не могу добраться. Да и дебаггер ведет себя страннос tkinter.

Плюс ко всему я и нормальное развитие биома сломал. Это видно по графику, когда вся гниль внезапно
обнуляется, при том что она должна рпссасываться очень медленно.
Посмотрел по подсказкам - если растение голодает его вес почему-то не уменьшается. Нужно
исправить.

Нашел ошибку. Свистопляска началась, когда я решил добавить возможность отключения отрисовки
растений, семян и т.д. Дело в том, что когда на холсте создаются объекты, им присваивается
числовой индекс. И обащение к этому объекту осуществляется по индексу (в том числе изменение его
свойств). По этому индексу у меня в словарях объектах идет тоступ. А если графический объект не
создается, то надо как то по другому создавать id объекта. Ну я и стал создавать из глобального
счетчика. Но оказывается, что номер графического объекта на холсте и номер объекта из глобального
счетчика  - это несвязанные величины, они могут пересекаться. Поэтому семена получают незаконый
доступ к растениям, а растения перекрашивают гниль в свой цвет. То есть накладывается отображаемое
и неотображаемое. От этого и симуляция сломалась - когда гниль демонстрировала мгновенное
исчезновение с поля.
Рештл проблему тем, что id есль у всех объектов. А у тех, которые должны отображаться есть еще и
gid. Глюки исчезли.

   020
   28.04.2020
Вижу, что все еще много вычислений дублируется. Например Куча статистики считается на уровне
клетки, а потом те же вычисления делаются на уровне игрового поля для вычисления глобальной
статистики. Переделал так, что основные вычисления делаются на уровне клетки, а на уровне
игрового поля значнеия, вычисленые для клеток просто суммируются.
Ну и еще не понравилось, что потоянно вычисляется количество растений, гниди и семян на игровом
поле. Раньше это делелось через вычисление длины списка. Сейчас я списки сущностей с глобального
уровня уюрад, ибо они дублируются. Вычислять сущности стало труднее. Поэтому я заменил их
глобальными счетчиками. Когда сущность создается, счетчик плюсуется. Когда исчезает - счетчик
уменьшается. Нормальна экономия - хотя бы в коде, если не в производительности. Использование
графического интерфейса и запланированных событий особо экономить не дает. Разве, что вывести
все вычисления в отдельный поток. Но это я не умею.


  021
  29.04.2020
Изменил алгоритм питания растений. Нужно все-таки соблюдать какую-то справедливость при
распределении еды. Раньше было так, кто кто стоит первым в списке, тот получает все. Те растения,
которые стоят в хвосте списка умирают первыми. Тогда я сделал, что кадлый ход на кадлой клетке
пара случайных растений менялась местами. Из за чего на симуляции получалось сплошное мигание.
Если на клетке мало еды, из-за перемешивания получается так, что сегодня один покушал, завтра
другой, вот они и перекрашиваются каждый ход. В итоге сделал так, что почва, имеющаяся на клетке
делится между растениями поровну. Если кому-то мало - он голодает. Если кто-то не смог съесть сою
пайку полностью - остаток переходит на следующий ход для повторного распределения.
А вот с принципом прорастания семян я справедливости добиться не могу. Ограничился просто
перемешиванием списка семян.

  022
  30.04.2020
Добавил в класс World централизоавнное создание логов, чтобы их можно было легко включать и
отключать. К тому же логам добавил довольно длинные суффиксы, во-первых, чтобы из них можно было
понять параметры симуляции, а во-вторых, чтобы при многочисленных симуляциях старые файлы не
затерались.
Опробовал возможность запускать несколько симуляций одну за другой. Для этого добавил новый файл
run_many_times.py В принципе получается запустить с серию симуляций с разнми значениями одного
параметра а именно - порог прорастания семени.Если он очень высок, наблюдается интересная картина:
растения первого поколения растут в сытости, а потом вымирают, потому что семечки не прорастают -
почтвы не хватает для прорастания. И толко черех некоторе время, когда гниль превратится в почву,
всходит второе поколение. И с третьим то же самое. Чем больше порог прорастания к максимальному
значению почвы, тем длиннее мертвые сезоны. Надо будет понаблюдать на большом промежутке времени,
потому что на первых этапах растения сильно синхронизованы.
Кстати, по поводу синхронизации - когда я ввел новый алгоритм распределения пищи, растения стали
вести себя совершенно одинаково. Им достается ожинаковый рацион пищи и они ведут себя как клоны.
Исчез огонек, случайность.

Исправил онибку, из-за которой семена не превращались в гниль. Твозраст семечки сравнивался с
предельным возрастом жизни. Видимо это сравнение как то проскакивало мимо равенства. Я заменил
равно на больше. Заработало как надо, но стало гораздо скучнее. Периоды опустошения исчезли.

  024
  добавил кучу всякого, лень вспоминать.


  025
  07.05.2020
  Сделал консольную версию, чтобы быстрее работало. Все равно я серии симулыяций ла нинуксовом
  компе запускаю из-по ssh, графический режим там только мешает.
  Работать стало раз в 50-100 быстрее. Кайф.

  026
  07.05.2020
Несколько дней потратил на прогрны симуляций. А оказывается, у меня начальное количество почвы
неправильно присавивалось. Оно всегда присваивалось таким, какое изначально устанавливалось в
файле констатн. А то, что я по этому значению целый цикл устраивал - все впустую.
Сейчас исправил. Ну и метрику подправил. Когда считалась сумма Всей гнили, переработанной в
почву. Там есть такой нюанс. Симуляция не заканчивается, пока вся гниль не переработается в
почву, даже если семян и растений на игровом поле уже нет. Так что метрика получается не очень
справедливая.  Сделал так, что при отсуствии живых сущностей переработка почвы не засчитывается.


  027
  012.05.2020
Добавил к программе базу данных. Пока не все в базу пишется, а только сведения о растениях и массе
клеток. За одну симуляцию получается база на 36 мегабайт. Но тестил и на многих прогонах. Размер
базы достигал 730 мегабайт. В одну из таблиц писалось 14 миллионов записей. Если эту бузу потом
проиндекситровать, то выборка идет довольно быстро - значительно быстрее, чем считается симуляция.
Написал пару тестов. Один из них проходит по всему циклу симуляции и достает массы всех клеток и
всех растений на каждом ходу. Отрабатывает меньше чем за полсекунды.

Сделать:

Включать и отключать рандом по желанию.

Метрику симуляции, выражающуюся одной строкой.

Нужно сделать обработку окончания симуляции. Чтобы надпись выводилась, типа все умерли. Или
о том, что истек срок симуляции.
В виде всплывающей подксазки или в отдельном фрейме.

Чтобы при нажатии на кнопку "шаг вперед" не было задержки выполнения как с обычными кадрами.

Кнопку ,чтобы проматывлось 10 шагов симуляции

